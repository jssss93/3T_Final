<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
<mapper namespace="review">

     <select id="REVIEW_selectList" parameterType="hashmap" resultType="hashmap">
      <![CDATA[
         SELECT
           	REVIEW_NO,
           	TITLE,
           	MEMBER_ID,
           	CONTENT,
           	REGDATE,
			READCNT,
			GOODS_NO,
			REF,
			RE_STEP,
			RE_LEVEL
			
           		
         FROM 
           	REVIEW
           	ORDER BY REVIEW_NO DESC
           		
      ]]>
</select>
   <insert id="REVIEW_insert" parameterType="hashmap">
      <![CDATA[
      
         INSERT INTO
		REVIEW (
			REVIEW_NO,
			TITLE,
			PASSWD,
			CONTENT,
			REGDATE,
			READCNT,

			REF,
			RE_STEP,
			RE_LEVEL,
			
			MEMBER_ID,
			GOODS_NO

		)
		VALUES (
			REVIEW_NO_SEQ.NEXTVAL,
			#{TITLE},
			#{PASSWD},
			#{CONTENT},
			SYSDATE,
			0,
		
		
			0,
			0,
			0,
		
			#{MEMBER_ID},
			#{GOODS_NO}
		)
    ]]>
</insert>

<select id="REVIEW_selectDetail" parameterType="hashmap" resultType="hashmap">
      <![CDATA[
        SELECT
            REVIEW_NO,
            TITLE,
            MEMBER_ID,
            REGDATE,
            CONTENT,
			READCNT,
			GOODS_NO

        FROM
            REVIEW
        WHERE
            REVIEW_NO = #{REVIEW_NO}       
      ]]>
</select>

<update id="REVIEW_update" parameterType="hashmap">
    <![CDATA[
        UPDATE 
			REVIEW
        SET
            TITLE = #{TITLE},
            CONTENT = #{CONTENT}
			
        WHERE
            REVIEW_NO = #{REVIEW_NO}   
    ]]>
</update>

<delete id="REVIEW_delete" parameterType="hashmap">
	 <![CDATA[
        delete FROM
            REVIEW
        WHERE
            REVIEW_NO = #{REVIEW_NO}   
    ]]>
</delete>

<delete id="REVIEW_Commentdelete" parameterType="hashmap">
	 <![CDATA[
        delete FROM
            REVIEW_COMMENT
        WHERE
            REVIEW_COMMENT_NO = #{REVIEW_COMMENT_NO}   
    ]]>
</delete>

<insert id="ReviewInsertComment" parameterType="hashmap">
      <![CDATA[
      
         INSERT INTO
		REVIEW_COMMENT (
			REVIEW_COMMENT_NO,
			REVIEW_ORIGIN_NO,
			NAME,
			PASSWD,
			CONTENT,
			REGDATE

		)
		VALUES (
			REVIEW_COMMENT_NO_SEQ.NEXTVAL,
			#{REVIEW_ORIGIN_NO},
			#{NAME},
			#{PASSWD},
			#{CONTENT},
			SYSDATE
		
		)
    ]]>
</insert>
    <select id="ReviewCommentSelectList" parameterType="hashmap" resultType="hashmap">
      <![CDATA[
         SELECT
           	REVIEW_COMMENT_NO,
           	REVIEW_ORIGIN_NO,
           	NAME,
           	CONTENT,
           	REGDATE
				
           		
         FROM 
           	REVIEW_COMMENT
         WHERE
         	REVIEW_ORIGIN_NO = #{REVIEW_NO }
           	ORDER BY REVIEW_COMMENT_NO DESC
           		
      ]]>
</select>

 <select id="ReveiwSelectSearchList" parameterType="hashmap" resultType="hashmap">
		SELECT 
			REVIEW_NO,
           	TITLE,
           	MEMBER_ID,
           	CONTENT,
           	REGDATE,
           	GOODS_NO
		FROM 
			REVIEW
		WHERE 
				
			<if test='SearchNum.equals("TITLE")'> 
			
			(TITLE LIKE '%' || #{SearchKeyword} || '%')
			
			</if>
			
			 <if test='SearchNum.equals("MEMBER_ID")'> 
			  
			(MEMBER_ID LIKE '%' || #{SearchKeyword} || '%')
			
			</if> 
			
			<if test='SearchNum.equals("CONTENT")'>
		
			(CONTENT LIKE '%' || #{SearchKeyword} || '%')
			</if>
			
			ORDER BY REVIEW_NO DESC

		
</select>

<select id="Review_GoodsSelectList" parameterType="hashmap" resultType="hashmap">
        <![CDATA[
          select 
 				A.GOODS_NO,
           		A.NAME,
           		A.PRICE,
                B.SAV_NAME
		  from
                GOODS A
          INNER JOIN 
                UPLOAD B 
          ON 
               A.GOODS_NO = B.GOODS_NO 
               
         ORDER BY 
               A.GOODS_NO DESC 
           		
        ]]>
    </select>
    <!-- QA 상품검색 -->
       <select id="Review_GoodsSearch" parameterType="hashmap" resultType="hashmap">
		SELECT 
				A.GOODS_NO,
           		A.NAME,
           		A.PRICE,
                B.SAV_NAME
		FROM 
			 	GOODS A
         		INNER JOIN 
                UPLOAD B 
        ON 
                A.GOODS_NO = B.GOODS_NO 	
                
		WHERE 
			<if test='SearchNum.equals("NAME")'> 	
			(NAME LIKE '%' || #{SearchKeyword} || '%')	
			</if>
			ORDER BY GOODS_NO DESC

		
</select>

 <select id="Review_GoodsSelect" parameterType="hashmap" resultType="hashmap">
      <![CDATA[
        SELECT
        	    A.GOODS_NO,
           		A.NAME,
           		A.PRICE,
                B.SAV_NAME
          FROM
                GOODS A
          INNER JOIN 
                UPLOAD B 
          ON 
               A.GOODS_NO = B.GOODS_NO 
          WHERE
               A.GOODS_NO = #{GOODS_NO}       
      ]]>
</select>

<select id="ReviewPasswdCheck" parameterType="hashmap" resultType="hashmap">
        <![CDATA[
           SELECT
           		REVIEW_COMMENT_NO,
           		PASSWD
           	FROM 
           		REVIEW_COMMENT
           	WHERE 
           		REVIEW_COMMENT_NO =#{REVIEW_COMMENT_NO}
           	AND
           	PASSWD = #{PASSWD}
           		
        ]]>
    </select>
</mapper>


